<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duke Energy Challenge - Personal Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: white;
            font-weight: bold;
        }

        .user-details h1 {
            color: #333;
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .user-details p {
            color: #666;
            font-size: 1.1em;
        }

        .user-stats {
            display: flex;
            gap: 30px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab {
            flex: 1;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .tab:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .tab.active {
            background: white;
            color: #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.6em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .real-time-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .data-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }

        .data-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .data-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .data-card .value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .data-card .unit {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .data-card .timestamp {
            font-size: 0.8em;
            opacity: 0.7;
            margin-top: 10px;
            border-top: 1px solid rgba(255,255,255,0.3);
            padding-top: 10px;
        }

        .live-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            margin-right: 5px;
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .impact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .impact-card {
            text-align: center;
            padding: 25px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 12px;
            transition: transform 0.3s ease;
        }

        .impact-card:hover {
            transform: translateY(-5px);
        }

        .impact-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .impact-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .impact-label {
            color: #666;
            font-size: 0.9em;
        }

        .challenge-list {
            display: grid;
            gap: 15px;
        }

        .challenge-item {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            border-left: 5px solid #667eea;
        }

        .challenge-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .challenge-item.completed {
            border-left-color: #4ade80;
            background: linear-gradient(135deg, #d4f8e8 0%, #a7dcc7 100%);
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .challenge-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .challenge-desc {
            color: #666;
            font-size: 0.9em;
        }

        .challenge-reward {
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .challenge-item.completed .challenge-reward {
            background: #4ade80;
        }

        .progress-bar {
            background: rgba(255,255,255,0.5);
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: #667eea;
            transition: width 1s ease;
            border-radius: 5px;
        }

        .challenge-item.completed .progress-fill {
            background: #4ade80;
        }

        .progress-text {
            font-size: 0.9em;
            color: #666;
            text-align: right;
        }

        .chart-container {
            margin-top: 20px;
            min-height: 400px;
        }

        .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .tip-card {
            padding: 20px;
            background: linear-gradient(135deg, #fff5e1 0%, #ffd89b 100%);
            border-radius: 10px;
            border-left: 4px solid #f59e0b;
        }

        .tip-card h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .tip-card p {
            color: #666;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .rank-badge {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .comparison-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .comparison-section h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 10px;
        }

        .status-badge.active {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-badge.completed {
            background: #d1fae5;
            color: #065f46;
        }

        .monthly-breakdown-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .breakdown-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 12px;
            border-left: 5px solid #667eea;
        }

        .breakdown-card h4 {
            color: #333;
            font-size: 1.1em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .breakdown-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .breakdown-stat:last-child {
            border-bottom: none;
        }

        .breakdown-label {
            color: #666;
            font-size: 0.9em;
        }

        .breakdown-value {
            color: #333;
            font-weight: 600;
            font-size: 1em;
        }

        .breakdown-comparison {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.5);
            border-radius: 8px;
        }

        .comparison-text {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .comparison-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.85em;
        }

        .comparison-badge.better {
            background: #d1fae5;
            color: #065f46;
        }

        .comparison-badge.worse {
            background: #fee2e2;
            color: #991b1b;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group label {
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="user-info">
                <div class="avatar">J</div>
                <div class="user-details">
                    <h1 id="userName">Jiyeong '27</h1>
                    <p id="userResidence">Trinity Residence Hall</p>
                </div>
            </div>
            <div class="user-stats">
                <div class="stat-item">
                    <div class="stat-value" id="userRank">--</div>
                    <div class="stat-label">Building Rank</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="userPoints">850</div>
                    <div class="stat-label">Green Points</div>
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('profile')">üè† Profile</button>
            <button class="tab" onclick="switchTab('impact')">üå± Impact</button>
            <button class="tab" onclick="switchTab('challenges')">üèÜ Challenges</button>
        </div>

        <!-- Profile Tab -->
        <div id="profile" class="tab-content active">
            <div class="card">
                <h2>
                    <span class="live-indicator"></span>
                    Real-Time Energy Data
                </h2>
                <div class="real-time-data">
                    <div class="data-card">
                        <h3>‚ö° Current Electricity</h3>
                        <div class="value" id="currentElectric">--</div>
                        <div class="unit">kWh this period</div>
                        <div class="timestamp">
                            üìÖ Last updated: <span id="lastUpdated">--</span>
                        </div>
                    </div>
                    <div class="data-card">
                        <h3>üíß Current Water Usage</h3>
                        <div class="value" id="currentWater">--</div>
                        <div class="unit">gallons this period</div>
                        <div class="timestamp">
                            üìÖ Last updated: <span id="lastUpdatedWater">--</span>
                        </div>
                    </div>
                    <div class="data-card">
                        <h3>üìä Efficiency Rating</h3>
                        <div class="value" id="efficiencyRating">--</div>
                        <div class="unit">out of 100</div>
                        <div class="timestamp">
                            üèÖ <span id="rankText">--</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üìà Your Building's Monthly Trends</h2>
                <div class="chart-container" id="monthlyChart"></div>
            </div>

            <div class="card">
                <div class="section-header">
                    <h2>üìä Monthly Energy Breakdown</h2>
                    <select id="monthSelector" onchange="updateMonthlyBreakdown()">
                        <option value="">Select a month...</option>
                    </select>
                </div>
                <div id="monthlyBreakdownContent">
                    <p style="text-align: center; color: #666; padding: 40px;">Select a month to view detailed breakdown</p>
                </div>
            </div>

            <div class="card">
                <h2>üè¢ Trinity vs Campus Average</h2>
                <div class="comparison-section">
                    <div class="filter-group" style="margin-bottom: 20px;">
                        <label style="margin-right: 10px; font-weight: 600;">Time Range:</label>
                        <select id="comparisonTimeRange" onchange="updateComparison()">
                            <option value="all">All Time</option>
                            <option value="12" selected>Last 12 Months</option>
                            <option value="6">Last 6 Months</option>
                            <option value="3">Last 3 Months</option>
                        </select>
                        <label style="margin-left: 20px; margin-right: 10px; font-weight: 600;">Metric:</label>
                        <select id="comparisonMetric" onchange="updateComparison()">
                            <option value="both" selected>Electricity & Water</option>
                            <option value="electric">Electricity Only</option>
                            <option value="water">Water Only</option>
                        </select>
                    </div>
                    <div class="chart-container" id="comparisonChart"></div>
                </div>
            </div>

            <div class="card">
                <h2>üí° Energy Saving Tips for Trinity Hall</h2>
                <div class="tips-grid">
                    <div class="tip-card">
                        <h4>üåô Night Mode</h4>
                        <p>Turn off common area lights after 11 PM. Could save 200 kWh/month!</p>
                    </div>
                    <div class="tip-card">
                        <h4>üöø Shorter Showers</h4>
                        <p>Reduce shower time by 2 minutes to save 1,000 gallons monthly.</p>
                    </div>
                    <div class="tip-card">
                        <h4>‚ùÑÔ∏è Thermostat Smart</h4>
                        <p>Set AC to 72¬∞F instead of 68¬∞F to reduce energy by 15%.</p>
                    </div>
                    <div class="tip-card">
                        <h4>üîå Unplug Devices</h4>
                        <p>Phantom power costs add up! Unplug chargers when not in use.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Impact Tab -->
        <div id="impact" class="tab-content">
            <div class="card">
                <h2>üåç Your Personal Environmental Impact</h2>
                <div class="impact-grid">
                    <div class="impact-card">
                        <div class="impact-icon">‚ö°</div>
                        <div class="impact-value" id="personalElectric">--</div>
                        <div class="impact-label">kWh/year (your share)</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">üíß</div>
                        <div class="impact-value" id="personalWater">--</div>
                        <div class="impact-label">gallons/year (your share)</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">üå´Ô∏è</div>
                        <div class="impact-value" id="carbonSaved">--</div>
                        <div class="impact-label">kg CO‚ÇÇ prevented</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">üå≥</div>
                        <div class="impact-value" id="treesEquivalent">--</div>
                        <div class="impact-label">trees planted equivalent</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üìä Impact Over Time</h2>
                <div class="chart-container" id="impactChart"></div>
            </div>

            <div class="card">
                <h2>üéØ Your Contribution to Duke's Sustainability Goals</h2>
                <div class="impact-grid">
                    <div class="impact-card">
                        <div class="impact-icon">üéØ</div>
                        <div class="impact-value">12%</div>
                        <div class="impact-label">Below campus average</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">üìâ</div>
                        <div class="impact-value">-850</div>
                        <div class="impact-label">kWh saved vs. baseline</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">üí∞</div>
                        <div class="impact-value">$127</div>
                        <div class="impact-label">Cost savings this year</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">üèÖ</div>
                        <div class="impact-value">Top 30%</div>
                        <div class="impact-label">Among all students</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Challenges Tab -->
        <div id="challenges" class="tab-content">
            <div class="card">
                <h2>üèÜ Active Challenges</h2>
                <div class="challenge-list" id="activeChallenges">
                    <!-- Challenges will be loaded here -->
                </div>
            </div>

            <div class="card">
                <h2>‚úÖ Completed Challenges</h2>
                <div class="challenge-list" id="completedChallenges">
                    <!-- Completed challenges will be loaded here -->
                </div>
            </div>

            <div class="card">
                <h2>üéÅ Rewards & Achievements</h2>
                <div class="impact-grid">
                    <div class="impact-card">
                        <div class="impact-icon">üèÖ</div>
                        <div class="impact-value">4</div>
                        <div class="impact-label">Total Challenges</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">‚≠ê</div>
                        <div class="impact-value">300</div>
                        <div class="impact-label">Points Earned</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">üéØ</div>
                        <div class="impact-value">75%</div>
                        <div class="impact-label">Success Rate</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-icon">üî•</div>
                        <div class="impact-value">15</div>
                        <div class="impact-label">Day Streak</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let userData = null;
        let challenges = [];
        let enhancedData = null;

        // Load data
        async function loadData() {
            try {
                const response = await fetch('/mnt/user-data/outputs/enhanced_trinity_data.json');
                const data = await response.json();
                userData = data.user;
                challenges = data.challenges;
                enhancedData = data.enhanced;
                initializeDashboard();
            } catch (error) {
                console.error('Error loading data:', error);
                loadEmbeddedData();
            }
        }

        function loadEmbeddedData() {
            userData = {
  "name": "Jiyeong '27",
  "residence": "Trinity Residence Hall",
  "rank": 26,
  "total_buildings": 32,
  "current_consumption": {
    "electric": 71502.0,
    "water": 28325.2,
    "last_updated": "2025-06-01 00:00:00"
  },
  "personal_impact": {
    "electric_yearly": 7775.17,
    "water_yearly": 3108.95,
    "carbon_saved": 5.44,
    "trees_equivalent": 0.26
  },
  "monthly_history": [
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202405,
      "Rate Schedule": "ELE",
      "Start Date": "2024-05-01 00:00:00",
      "End Date": "2024-06-01 00:00:00",
      "Days": 31,
      "Common Use": NaN,
      "Month": "2024-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202405,
      "Rate Schedule": "W&S",
      "Start Date": "2024-05-01 00:00:00",
      "End Date": "2024-06-01 00:00:00",
      "Days": 31,
      "Common Use": 350.0,
      "Month": "2024-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202405,
      "Rate Schedule": "W&S",
      "Start Date": "2024-05-01 00:00:00",
      "End Date": "2024-06-01 00:00:00",
      "Days": 31,
      "Common Use": 5540.1,
      "Month": "2024-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202405,
      "Rate Schedule": "Irrigation",
      "Start Date": "2024-05-01 00:00:00",
      "End Date": "2024-06-01 00:00:00",
      "Days": 31,
      "Common Use": 7710.0,
      "Month": "2024-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202405,
      "Rate Schedule": "Storm Water",
      "Start Date": "2024-05-01 00:00:00",
      "End Date": "2024-06-01 00:00:00",
      "Days": 31,
      "Common Use": 21165.0,
      "Month": "2024-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202405,
      "Rate Schedule": "CHW",
      "Start Date": "2024-05-01 00:00:00",
      "End Date": "2024-06-01 00:00:00",
      "Days": 31,
      "Common Use": 51077.8,
      "Month": "2024-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202405,
      "Rate Schedule": "ELE",
      "Start Date": "2024-05-01 00:00:00",
      "End Date": "2024-06-01 00:00:00",
      "Days": 31,
      "Common Use": 56442.0,
      "Month": "2024-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202405,
      "Rate Schedule": "HW",
      "Start Date": "2024-05-01 00:00:00",
      "End Date": "2024-06-01 00:00:00",
      "Days": 31,
      "Common Use": 279068.5,
      "Month": "2024-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202406,
      "Rate Schedule": "ELE",
      "Start Date": "2024-06-01 00:00:00",
      "End Date": "2024-07-01 00:00:00",
      "Days": 30,
      "Common Use": NaN,
      "Month": "2024-07"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202406,
      "Rate Schedule": "W&S",
      "Start Date": "2024-06-01 00:00:00",
      "End Date": "2024-07-01 00:00:00",
      "Days": 30,
      "Common Use": 30.0,
      "Month": "2024-07"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202406,
      "Rate Schedule": "W&S",
      "Start Date": "2024-06-01 00:00:00",
      "End Date": "2024-07-01 00:00:00",
      "Days": 30,
      "Common Use": 824.0,
      "Month": "2024-07"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202406,
      "Rate Schedule": "Storm Water",
      "Start Date": "2024-06-01 00:00:00",
      "End Date": "2024-07-01 00:00:00",
      "Days": 30,
      "Common Use": 21165.0,
      "Month": "2024-07"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202406,
      "Rate Schedule": "Irrigation",
      "Start Date": "2024-06-01 00:00:00",
      "End Date": "2024-07-01 00:00:00",
      "Days": 30,
      "Common Use": 21464.0,
      "Month": "2024-07"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202406,
      "Rate Schedule": "ELE",
      "Start Date": "2024-06-01 00:00:00",
      "End Date": "2024-07-01 00:00:00",
      "Days": 30,
      "Common Use": 42674.0,
      "Month": "2024-07"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202406,
      "Rate Schedule": "CHW",
      "Start Date": "2024-06-01 00:00:00",
      "End Date": "2024-07-01 00:00:00",
      "Days": 30,
      "Common Use": 67319.7,
      "Month": "2024-07"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202406,
      "Rate Schedule": "HW",
      "Start Date": "2024-06-01 00:00:00",
      "End Date": "2024-07-01 00:00:00",
      "Days": 30,
      "Common Use": 275186.8,
      "Month": "2024-07"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202407,
      "Rate Schedule": "ELE",
      "Start Date": "2024-07-01 00:00:00",
      "End Date": "2024-08-01 00:00:00",
      "Days": 31,
      "Common Use": NaN,
      "Month": "2024-08"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202407,
      "Rate Schedule": "W&S",
      "Start Date": "2024-07-01 00:00:00",
      "End Date": "2024-08-01 00:00:00",
      "Days": 31,
      "Common Use": 1100.0,
      "Month": "2024-08"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202407,
      "Rate Schedule": "W&S",
      "Start Date": "2024-07-01 00:00:00",
      "End Date": "2024-08-01 00:00:00",
      "Days": 31,
      "Common Use": 4666.0,
      "Month": "2024-08"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202407,
      "Rate Schedule": "Irrigation",
      "Start Date": "2024-07-01 00:00:00",
      "End Date": "2024-08-01 00:00:00",
      "Days": 31,
      "Common Use": 7468.0,
      "Month": "2024-08"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202407,
      "Rate Schedule": "Storm Water",
      "Start Date": "2024-07-01 00:00:00",
      "End Date": "2024-08-01 00:00:00",
      "Days": 31,
      "Common Use": 21165.0,
      "Month": "2024-08"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202407,
      "Rate Schedule": "ELE",
      "Start Date": "2024-07-01 00:00:00",
      "End Date": "2024-08-01 00:00:00",
      "Days": 31,
      "Common Use": 56591.0,
      "Month": "2024-08"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202407,
      "Rate Schedule": "CHW",
      "Start Date": "2024-07-01 00:00:00",
      "End Date": "2024-08-01 00:00:00",
      "Days": 31,
      "Common Use": 81912.3,
      "Month": "2024-08"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202407,
      "Rate Schedule": "HW",
      "Start Date": "2024-07-01 00:00:00",
      "End Date": "2024-08-01 00:00:00",
      "Days": 31,
      "Common Use": 308725.8,
      "Month": "2024-08"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202408,
      "Rate Schedule": "ELE",
      "Start Date": "2024-08-01 00:00:00",
      "End Date": "2024-09-01 00:00:00",
      "Days": 31,
      "Common Use": NaN,
      "Month": "2024-09"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202408,
      "Rate Schedule": "W&S",
      "Start Date": "2024-08-01 00:00:00",
      "End Date": "2024-09-01 00:00:00",
      "Days": 31,
      "Common Use": 3380.0,
      "Month": "2024-09"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202408,
      "Rate Schedule": "Irrigation",
      "Start Date": "2024-08-01 00:00:00",
      "End Date": "2024-09-01 00:00:00",
      "Days": 31,
      "Common Use": 6067.0,
      "Month": "2024-09"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202408,
      "Rate Schedule": "W&S",
      "Start Date": "2024-08-01 00:00:00",
      "End Date": "2024-09-01 00:00:00",
      "Days": 31,
      "Common Use": 15562.0,
      "Month": "2024-09"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202408,
      "Rate Schedule": "Storm Water",
      "Start Date": "2024-08-01 00:00:00",
      "End Date": "2024-09-01 00:00:00",
      "Days": 31,
      "Common Use": 21165.0,
      "Month": "2024-09"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202408,
      "Rate Schedule": "ELE",
      "Start Date": "2024-08-01 00:00:00",
      "End Date": "2024-09-01 00:00:00",
      "Days": 31,
      "Common Use": 54898.0,
      "Month": "2024-09"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202408,
      "Rate Schedule": "CHW",
      "Start Date": "2024-08-01 00:00:00",
      "End Date": "2024-09-01 00:00:00",
      "Days": 31,
      "Common Use": 84536.0,
      "Month": "2024-09"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202408,
      "Rate Schedule": "HW",
      "Start Date": "2024-08-01 00:00:00",
      "End Date": "2024-09-01 00:00:00",
      "Days": 31,
      "Common Use": 365150.4,
      "Month": "2024-09"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202409,
      "Rate Schedule": "ELE",
      "Start Date": "2024-09-01 00:00:00",
      "End Date": "2024-10-01 00:00:00",
      "Days": 30,
      "Common Use": NaN,
      "Month": "2024-10"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202409,
      "Rate Schedule": "W&S",
      "Start Date": "2024-09-01 00:00:00",
      "End Date": "2024-10-01 00:00:00",
      "Days": 30,
      "Common Use": 5430.0,
      "Month": "2024-10"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202409,
      "Rate Schedule": "Irrigation",
      "Start Date": "2024-09-01 00:00:00",
      "End Date": "2024-10-01 00:00:00",
      "Days": 30,
      "Common Use": 6595.0,
      "Month": "2024-10"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202409,
      "Rate Schedule": "Storm Water",
      "Start Date": "2024-09-01 00:00:00",
      "End Date": "2024-10-01 00:00:00",
      "Days": 30,
      "Common Use": 21165.0,
      "Month": "2024-10"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202409,
      "Rate Schedule": "W&S",
      "Start Date": "2024-09-01 00:00:00",
      "End Date": "2024-10-01 00:00:00",
      "Days": 30,
      "Common Use": 29493.8,
      "Month": "2024-10"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202409,
      "Rate Schedule": "ELE",
      "Start Date": "2024-09-01 00:00:00",
      "End Date": "2024-10-01 00:00:00",
      "Days": 30,
      "Common Use": 57242.0,
      "Month": "2024-10"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202409,
      "Rate Schedule": "CHW",
      "Start Date": "2024-09-01 00:00:00",
      "End Date": "2024-10-01 00:00:00",
      "Days": 30,
      "Common Use": 79896.1,
      "Month": "2024-10"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202409,
      "Rate Schedule": "HW",
      "Start Date": "2024-09-01 00:00:00",
      "End Date": "2024-10-01 00:00:00",
      "Days": 30,
      "Common Use": 415538.4,
      "Month": "2024-10"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202410,
      "Rate Schedule": "ELE",
      "Start Date": "2024-10-01 00:00:00",
      "End Date": "2024-11-01 00:00:00",
      "Days": 31,
      "Common Use": NaN,
      "Month": "2024-11"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202410,
      "Rate Schedule": "W&S",
      "Start Date": "2024-10-01 00:00:00",
      "End Date": "2024-11-01 00:00:00",
      "Days": 31,
      "Common Use": 1070.0,
      "Month": "2024-11"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202410,
      "Rate Schedule": "Irrigation",
      "Start Date": "2024-10-01 00:00:00",
      "End Date": "2024-11-01 00:00:00",
      "Days": 31,
      "Common Use": 4640.0,
      "Month": "2024-11"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202410,
      "Rate Schedule": "Storm Water",
      "Start Date": "2024-10-01 00:00:00",
      "End Date": "2024-11-01 00:00:00",
      "Days": 31,
      "Common Use": 21165.0,
      "Month": "2024-11"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202410,
      "Rate Schedule": "W&S",
      "Start Date": "2024-10-01 00:00:00",
      "End Date": "2024-11-01 00:00:00",
      "Days": 31,
      "Common Use": 25874.1,
      "Month": "2024-11"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202410,
      "Rate Schedule": "CHW",
      "Start Date": "2024-10-01 00:00:00",
      "End Date": "2024-11-01 00:00:00",
      "Days": 31,
      "Common Use": 51688.1,
      "Month": "2024-11"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202410,
      "Rate Schedule": "ELE",
      "Start Date": "2024-10-01 00:00:00",
      "End Date": "2024-11-01 00:00:00",
      "Days": 31,
      "Common Use": 73303.0,
      "Month": "2024-11"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202410,
      "Rate Schedule": "HW",
      "Start Date": "2024-10-01 00:00:00",
      "End Date": "2024-11-01 00:00:00",
      "Days": 31,
      "Common Use": 478622.5,
      "Month": "2024-11"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202411,
      "Rate Schedule": "ELE",
      "Start Date": "2024-11-01 00:00:00",
      "End Date": "2024-12-01 00:00:00",
      "Days": 30,
      "Common Use": NaN,
      "Month": "2024-12"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202411,
      "Rate Schedule": "W&S",
      "Start Date": "2024-11-01 00:00:00",
      "End Date": "2024-12-01 00:00:00",
      "Days": 30,
      "Common Use": 2700.0,
      "Month": "2024-12"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202411,
      "Rate Schedule": "Irrigation",
      "Start Date": "2024-11-01 00:00:00",
      "End Date": "2024-12-01 00:00:00",
      "Days": 30,
      "Common Use": 3218.0,
      "Month": "2024-12"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202411,
      "Rate Schedule": "Storm Water",
      "Start Date": "2024-11-01 00:00:00",
      "End Date": "2024-12-01 00:00:00",
      "Days": 30,
      "Common Use": 21165.0,
      "Month": "2024-12"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202411,
      "Rate Schedule": "CHW",
      "Start Date": "2024-11-01 00:00:00",
      "End Date": "2024-12-01 00:00:00",
      "Days": 30,
      "Common Use": 26426.0,
      "Month": "2024-12"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202411,
      "Rate Schedule": "W&S",
      "Start Date": "2024-11-01 00:00:00",
      "End Date": "2024-12-01 00:00:00",
      "Days": 30,
      "Common Use": 26684.0,
      "Month": "2024-12"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202411,
      "Rate Schedule": "ELE",
      "Start Date": "2024-11-01 00:00:00",
      "End Date": "2024-12-01 00:00:00",
      "Days": 30,
      "Common Use": 56794.0,
      "Month": "2024-12"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202411,
      "Rate Schedule": "HW",
      "Start Date": "2024-11-01 00:00:00",
      "End Date": "2024-12-01 00:00:00",
      "Days": 30,
      "Common Use": 393520.1,
      "Month": "2024-12"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202412,
      "Rate Schedule": "ELE",
      "Start Date": "2024-12-01 00:00:00",
      "End Date": "2025-01-01 00:00:00",
      "Days": 31,
      "Common Use": NaN,
      "Month": "2025-01"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202412,
      "Rate Schedule": "Irrigation",
      "Start Date": "2024-12-01 00:00:00",
      "End Date": "2025-01-01 00:00:00",
      "Days": 31,
      "Common Use": 10.0,
      "Month": "2025-01"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202412,
      "Rate Schedule": "W&S",
      "Start Date": "2024-12-01 00:00:00",
      "End Date": "2025-01-01 00:00:00",
      "Days": 31,
      "Common Use": 720.0,
      "Month": "2025-01"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202412,
      "Rate Schedule": "CHW",
      "Start Date": "2024-12-01 00:00:00",
      "End Date": "2025-01-01 00:00:00",
      "Days": 31,
      "Common Use": 7455.9,
      "Month": "2025-01"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202412,
      "Rate Schedule": "W&S",
      "Start Date": "2024-12-01 00:00:00",
      "End Date": "2025-01-01 00:00:00",
      "Days": 31,
      "Common Use": 14161.0,
      "Month": "2025-01"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202412,
      "Rate Schedule": "Storm Water",
      "Start Date": "2024-12-01 00:00:00",
      "End Date": "2025-01-01 00:00:00",
      "Days": 31,
      "Common Use": 21165.0,
      "Month": "2025-01"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202412,
      "Rate Schedule": "ELE",
      "Start Date": "2024-12-01 00:00:00",
      "End Date": "2025-01-01 00:00:00",
      "Days": 31,
      "Common Use": 75455.0,
      "Month": "2025-01"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202412,
      "Rate Schedule": "HW",
      "Start Date": "2024-12-01 00:00:00",
      "End Date": "2025-01-01 00:00:00",
      "Days": 31,
      "Common Use": 453988.0,
      "Month": "2025-01"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202501,
      "Rate Schedule": "ELE",
      "Start Date": "2025-01-01 00:00:00",
      "End Date": "2025-02-01 00:00:00",
      "Days": 31,
      "Common Use": NaN,
      "Month": "2025-02"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202501,
      "Rate Schedule": "Irrigation",
      "Start Date": "2025-01-01 00:00:00",
      "End Date": "2025-02-01 00:00:00",
      "Days": 31,
      "Common Use": 0.0,
      "Month": "2025-02"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202501,
      "Rate Schedule": "W&S",
      "Start Date": "2025-01-01 00:00:00",
      "End Date": "2025-02-01 00:00:00",
      "Days": 31,
      "Common Use": 1670.0,
      "Month": "2025-02"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202501,
      "Rate Schedule": "CHW",
      "Start Date": "2025-01-01 00:00:00",
      "End Date": "2025-02-01 00:00:00",
      "Days": 31,
      "Common Use": 19337.5,
      "Month": "2025-02"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202501,
      "Rate Schedule": "Storm Water",
      "Start Date": "2025-01-01 00:00:00",
      "End Date": "2025-02-01 00:00:00",
      "Days": 31,
      "Common Use": 21165.0,
      "Month": "2025-02"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202501,
      "Rate Schedule": "W&S",
      "Start Date": "2025-01-01 00:00:00",
      "End Date": "2025-02-01 00:00:00",
      "Days": 31,
      "Common Use": 22817.0,
      "Month": "2025-02"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202501,
      "Rate Schedule": "ELE",
      "Start Date": "2025-01-01 00:00:00",
      "End Date": "2025-02-01 00:00:00",
      "Days": 31,
      "Common Use": 71905.0,
      "Month": "2025-02"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202501,
      "Rate Schedule": "HW",
      "Start Date": "2025-01-01 00:00:00",
      "End Date": "2025-02-01 00:00:00",
      "Days": 31,
      "Common Use": 638865.3,
      "Month": "2025-02"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202502,
      "Rate Schedule": "ELE",
      "Start Date": "2025-02-01 00:00:00",
      "End Date": "2025-03-01 00:00:00",
      "Days": 28,
      "Common Use": NaN,
      "Month": "2025-03"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202502,
      "Rate Schedule": "Irrigation",
      "Start Date": "2025-02-01 00:00:00",
      "End Date": "2025-03-01 00:00:00",
      "Days": 28,
      "Common Use": 0.0,
      "Month": "2025-03"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202502,
      "Rate Schedule": "W&S",
      "Start Date": "2025-02-01 00:00:00",
      "End Date": "2025-03-01 00:00:00",
      "Days": 28,
      "Common Use": 3430.0,
      "Month": "2025-03"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202502,
      "Rate Schedule": "Storm Water",
      "Start Date": "2025-02-01 00:00:00",
      "End Date": "2025-03-01 00:00:00",
      "Days": 28,
      "Common Use": 21165.0,
      "Month": "2025-03"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202502,
      "Rate Schedule": "W&S",
      "Start Date": "2025-02-01 00:00:00",
      "End Date": "2025-03-01 00:00:00",
      "Days": 28,
      "Common Use": 24577.0,
      "Month": "2025-03"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202502,
      "Rate Schedule": "CHW",
      "Start Date": "2025-02-01 00:00:00",
      "End Date": "2025-03-01 00:00:00",
      "Days": 28,
      "Common Use": 33062.5,
      "Month": "2025-03"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202502,
      "Rate Schedule": "ELE",
      "Start Date": "2025-02-01 00:00:00",
      "End Date": "2025-03-01 00:00:00",
      "Days": 28,
      "Common Use": 89337.0,
      "Month": "2025-03"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202502,
      "Rate Schedule": "HW",
      "Start Date": "2025-02-01 00:00:00",
      "End Date": "2025-03-01 00:00:00",
      "Days": 28,
      "Common Use": 527314.8,
      "Month": "2025-03"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202503,
      "Rate Schedule": "ELE",
      "Start Date": "2025-03-01 00:00:00",
      "End Date": "2025-04-01 00:00:00",
      "Days": 31,
      "Common Use": NaN,
      "Month": "2025-04"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202503,
      "Rate Schedule": "Irrigation",
      "Start Date": "2025-03-01 00:00:00",
      "End Date": "2025-04-01 00:00:00",
      "Days": 31,
      "Common Use": 296.0,
      "Month": "2025-04"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202503,
      "Rate Schedule": "W&S",
      "Start Date": "2025-03-01 00:00:00",
      "End Date": "2025-04-01 00:00:00",
      "Days": 31,
      "Common Use": 2790.0,
      "Month": "2025-04"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202503,
      "Rate Schedule": "Storm Water",
      "Start Date": "2025-03-01 00:00:00",
      "End Date": "2025-04-01 00:00:00",
      "Days": 31,
      "Common Use": 21165.0,
      "Month": "2025-04"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202503,
      "Rate Schedule": "W&S",
      "Start Date": "2025-03-01 00:00:00",
      "End Date": "2025-04-01 00:00:00",
      "Days": 31,
      "Common Use": 21352.8,
      "Month": "2025-04"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202503,
      "Rate Schedule": "CHW",
      "Start Date": "2025-03-01 00:00:00",
      "End Date": "2025-04-01 00:00:00",
      "Days": 31,
      "Common Use": 30872.3,
      "Month": "2025-04"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202503,
      "Rate Schedule": "ELE",
      "Start Date": "2025-03-01 00:00:00",
      "End Date": "2025-04-01 00:00:00",
      "Days": 31,
      "Common Use": 71374.0,
      "Month": "2025-04"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202503,
      "Rate Schedule": "HW",
      "Start Date": "2025-03-01 00:00:00",
      "End Date": "2025-04-01 00:00:00",
      "Days": 31,
      "Common Use": 438434.5,
      "Month": "2025-04"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202504,
      "Rate Schedule": "ELE",
      "Start Date": "2025-04-01 00:00:00",
      "End Date": "2025-05-01 00:00:00",
      "Days": 30,
      "Common Use": NaN,
      "Month": "2025-05"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS02",
      "Meter": "WS02-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202504,
      "Rate Schedule": "W&S",
      "Start Date": "2025-04-01 00:00:00",
      "End Date": "2025-05-01 00:00:00",
      "Days": 30,
      "Common Use": 4370.0,
      "Month": "2025-05"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS03",
      "Meter": "WS03-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202504,
      "Rate Schedule": "Irrigation",
      "Start Date": "2025-04-01 00:00:00",
      "End Date": "2025-05-01 00:00:00",
      "Days": 30,
      "Common Use": 6510.0,
      "Month": "2025-05"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_STORM01",
      "Meter": "STORM01-7237-Stip Trinity Residence Hall",
      "Commodity ": "Storm Drainage",
      "Billing Period": 202504,
      "Rate Schedule": "Storm Water",
      "Start Date": "2025-04-01 00:00:00",
      "End Date": "2025-05-01 00:00:00",
      "Days": 30,
      "Common Use": 21165.0,
      "Month": "2025-05"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_WS01",
      "Meter": "WS01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Water and Sewer",
      "Billing Period": 202504,
      "Rate Schedule": "W&S",
      "Start Date": "2025-04-01 00:00:00",
      "End Date": "2025-05-01 00:00:00",
      "Days": 30,
      "Common Use": 28325.2,
      "Month": "2025-05"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202504,
      "Rate Schedule": "CHW",
      "Start Date": "2025-04-01 00:00:00",
      "End Date": "2025-05-01 00:00:00",
      "Days": 30,
      "Common Use": 47084.3,
      "Month": "2025-05"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_ELE01",
      "Meter": "ELE01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Electric",
      "Billing Period": 202504,
      "Rate Schedule": "ELE",
      "Start Date": "2025-04-01 00:00:00",
      "End Date": "2025-05-01 00:00:00",
      "Days": 30,
      "Common Use": 71502.0,
      "Month": "2025-05"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202504,
      "Rate Schedule": "HW",
      "Start Date": "2025-04-01 00:00:00",
      "End Date": "2025-05-01 00:00:00",
      "Days": 30,
      "Common Use": 383161.0,
      "Month": "2025-05"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_CHW01",
      "Meter": "CHW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Chilled Water",
      "Billing Period": 202505,
      "Rate Schedule": "CHW",
      "Start Date": "2025-05-01 00:00:00",
      "End Date": "2025-06-01 00:00:00",
      "Days": 31,
      "Common Use": 55587.3,
      "Month": "2025-06"
    },
    {
      "Place Code": 7237,
      "Place": "Trinity Residence Hall",
      "Meter Code": "7237_HW01",
      "Meter": "HW01-7237-Sub Trinity Residence Hall",
      "Commodity ": "Hot Water",
      "Billing Period": 202505,
      "Rate Schedule": "HW",
      "Start Date": "2025-05-01 00:00:00",
      "End Date": "2025-06-01 00:00:00",
      "Days": 31,
      "Common Use": 363073.6,
      "Month": "2025-06"
    }
  ]
};
            challenges = [
  {
    "id": 1,
    "name": "Energy Saver",
    "description": "Reduce electricity by 10% this month",
    "progress": 65,
    "target": 100,
    "reward": 50,
    "status": "active"
  },
  {
    "id": 2,
    "name": "Water Warrior",
    "description": "Use less than 500 gallons per person",
    "progress": 80,
    "target": 100,
    "reward": 75,
    "status": "active"
  },
  {
    "id": 3,
    "name": "Sustainability Champion",
    "description": "Maintain top 10 ranking for 3 months",
    "progress": 33,
    "target": 100,
    "reward": 150,
    "status": "active"
  },
  {
    "id": 4,
    "name": "Green Team Leader",
    "description": "Complete all daily eco-tips",
    "progress": 100,
    "target": 100,
    "reward": 25,
    "status": "completed"
  }
];
            initializeDashboard();
        }

        function initializeDashboard() {
            updateProfileTab();
            updateImpactTab();
            updateChallengesTab();
            if (enhancedData && enhancedData.available_months) {
                populateMonthSelector();
            }
        }

        function populateMonthSelector() {
            const selector = document.getElementById('monthSelector');
            if (!selector) return;
            
            selector.innerHTML = '<option value="">Select a month...</option>';
            
            enhancedData.available_months.forEach(([monthCode, monthName]) => {
                const option = document.createElement('option');
                option.value = monthCode;
                option.textContent = monthName;
                selector.appendChild(option);
            });
        }

        function updateMonthlyBreakdown() {
            const selectedMonth = document.getElementById('monthSelector').value;
            const container = document.getElementById('monthlyBreakdownContent');
            
            if (!container) return;
            
            if (!selectedMonth) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Select a month to view detailed breakdown</p>';
                return;
            }

            const monthData = enhancedData.monthly_breakdown[selectedMonth];
            if (!monthData || !monthData.data || monthData.data.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">No data available for this month</p>';
                return;
            }

            let html = `<div class="monthly-breakdown-grid">`;
            
            monthData.data.forEach(item => {
                const commodity = item['Commodity '];
                const trinityUsage = Math.round(item['Common Use'] || 0);
                const campusAvg = Math.round(item['Campus_Avg_Per_Building'] || 0);
                const difference = trinityUsage - campusAvg;
                const percentDiff = campusAvg > 0 ? ((difference / campusAvg) * 100).toFixed(1) : 0;
                const isBetter = difference < 0;
                
                let icon = '‚ö°';
                let unit = 'kWh';
                if (commodity === 'Water and Sewer') {
                    icon = 'üíß';
                    unit = 'gallons';
                } else if (commodity === 'Chilled Water') {
                    icon = '‚ùÑÔ∏è';
                    unit = 'units';
                } else if (commodity === 'Hot Water') {
                    icon = 'üå°Ô∏è';
                    unit = 'units';
                } else if (commodity === 'Steam') {
                    icon = 'üí®';
                    unit = 'units';
                }

                html += `
                    <div class="breakdown-card">
                        <h4>${icon} ${commodity}</h4>
                        <div class="breakdown-stat">
                            <span class="breakdown-label">Trinity Usage:</span>
                            <span class="breakdown-value">${trinityUsage.toLocaleString()} ${unit}</span>
                        </div>
                        <div class="breakdown-stat">
                            <span class="breakdown-label">Campus Avg:</span>
                            <span class="breakdown-value">${campusAvg.toLocaleString()} ${unit}</span>
                        </div>
                        <div class="breakdown-stat">
                            <span class="breakdown-label">Difference:</span>
                            <span class="breakdown-value" style="color: ${isBetter ? '#059669' : '#dc2626'}">
                                ${difference > 0 ? '+' : ''}${difference.toLocaleString()} ${unit}
                            </span>
                        </div>
                        <div class="breakdown-comparison">
                            <div class="comparison-text">
                                <span class="comparison-badge ${isBetter ? 'better' : 'worse'}">
                                    ${isBetter ? '‚úì ' : ''}${Math.abs(percentDiff)}% ${isBetter ? 'below' : 'above'} average
                                </span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += `</div>`;
            container.innerHTML = html;
        }

        function updateComparison() {
            if (!enhancedData) return;
            
            const timeRange = document.getElementById('comparisonTimeRange').value;
            const metric = document.getElementById('comparisonMetric').value;
            
            // Filter data based on time range
            let filteredData = enhancedData.comparison_data;
            
            if (timeRange !== 'all') {
                const months = parseInt(timeRange);
                const allMonths = enhancedData.available_months.map(m => m[0]).sort().reverse();
                const selectedMonths = allMonths.slice(0, months);
                filteredData = filteredData.filter(d => selectedMonths.includes(d.Month));
            }
            
            // Filter by commodity
            let commodities = [];
            if (metric === 'electric' || metric === 'both') {
                commodities.push('Electric');
            }
            if (metric === 'water' || metric === 'both') {
                commodities.push('Water and Sewer');
            }
            
            filteredData = filteredData.filter(d => commodities.includes(d['Commodity ']));
            
            // Sort by date
            filteredData.sort((a, b) => a.Month.localeCompare(b.Month));
            
            // Create traces
            const traces = [];
            
            commodities.forEach(commodity => {
                const commodityData = filteredData.filter(d => d['Commodity '] === commodity);
                
                const trinityTrace = {
                    x: commodityData.map(d => d.MonthName),
                    y: commodityData.map(d => Math.round(d['Common Use'] || 0)),
                    name: `Trinity - ${commodity === 'Electric' ? 'Electricity' : 'Water'}`,
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { width: 3, color: commodity === 'Electric' ? '#667eea' : '#764ba2' },
                    marker: { size: 8 }
                };
                
                const campusTrace = {
                    x: commodityData.map(d => d.MonthName),
                    y: commodityData.map(d => Math.round(d['Campus_Avg_Per_Building'] || 0)),
                    name: `Campus Avg - ${commodity === 'Electric' ? 'Electricity' : 'Water'}`,
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: { width: 3, dash: 'dash', color: commodity === 'Electric' ? '#a5b4fc' : '#c084fc' },
                    marker: { size: 8, symbol: 'square' }
                };
                
                traces.push(trinityTrace, campusTrace);
            });

            const layout = {
                title: 'Trinity vs Campus Average Over Time',
                xaxis: { title: 'Month', tickangle: -45 },
                yaxis: { title: 'Consumption (units)' },
                showlegend: true,
                hovermode: 'closest',
                height: 500
            };

            Plotly.newPlot('comparisonChart', traces, layout, {responsive: true});
        }

        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
        }

        function updateProfileTab() {
            // Update header stats
            document.getElementById('userRank').textContent = `${userData.rank}/${userData.total_buildings}`;
            
            // Update real-time data
            const electric = Math.round(userData.current_consumption.electric);
            const water = Math.round(userData.current_consumption.water);
            
            document.getElementById('currentElectric').textContent = electric.toLocaleString();
            document.getElementById('currentWater').textContent = water.toLocaleString();
            
            const lastUpdate = new Date(userData.current_consumption.last_updated);
            const formattedDate = lastUpdate.toLocaleString('en-US', {
                month: 'short',
                day: 'numeric',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            document.getElementById('lastUpdated').textContent = formattedDate;
            document.getElementById('lastUpdatedWater').textContent = formattedDate;
            
            // Calculate efficiency rating
            const efficiency = Math.round(100 - ((userData.rank / userData.total_buildings) * 100));
            document.getElementById('efficiencyRating').textContent = efficiency;
            document.getElementById('rankText').textContent = `Rank ${userData.rank} of ${userData.total_buildings}`;
            
            // Render monthly trends chart
            renderMonthlyTrends();
            if (enhancedData) {
                updateComparison();
            }
        }

        function renderMonthlyTrends() {
            const monthlyData = userData.monthly_history;
            
            // Group by month and commodity
            const electricData = monthlyData
                .filter(d => d['Commodity '] === 'Electric')
                .sort((a, b) => new Date(a['End Date']) - new Date(b['End Date']));
            
            const waterData = monthlyData
                .filter(d => d['Commodity '] === 'Water and Sewer')
                .sort((a, b) => new Date(a['End Date']) - new Date(b['End Date']));

            const electricTrace = {
                x: electricData.map(d => new Date(d['End Date']).toLocaleDateString('en-US', {month: 'short', year: 'numeric'})),
                y: electricData.map(d => Math.round((d['Common Use'] || 0) / 1000)),
                name: 'Electricity (kWh, thousands)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#667eea', width: 3 },
                marker: { size: 8 }
            };

            const waterTrace = {
                x: waterData.map(d => new Date(d['End Date']).toLocaleDateString('en-US', {month: 'short', year: 'numeric'})),
                y: waterData.map(d => Math.round((d['Common Use'] || 0) / 100)),
                name: 'Water (hundreds of gallons)',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#764ba2', width: 3 },
                marker: { size: 8 },
                yaxis: 'y2'
            };

            const layout = {
                title: 'Trinity Hall - Last 12 Months',
                xaxis: { title: 'Month' },
                yaxis: { 
                    title: 'Electricity (kWh, thousands)',
                    titlefont: { color: '#667eea' },
                    tickfont: { color: '#667eea' }
                },
                yaxis2: {
                    title: 'Water (hundreds of gallons)',
                    titlefont: { color: '#764ba2' },
                    tickfont: { color: '#764ba2' },
                    overlaying: 'y',
                    side: 'right'
                },
                showlegend: true,
                hovermode: 'closest'
            };

            Plotly.newPlot('monthlyChart', [electricTrace, waterTrace], layout, {responsive: true});
        }


        function updateImpactTab() {
            // Update personal impact stats
            document.getElementById('personalElectric').textContent = 
                Math.round(userData.personal_impact.electric_yearly).toLocaleString();
            document.getElementById('personalWater').textContent = 
                Math.round(userData.personal_impact.water_yearly).toLocaleString();
            document.getElementById('carbonSaved').textContent = 
                userData.personal_impact.carbon_saved.toFixed(1);
            document.getElementById('treesEquivalent').textContent = 
                userData.personal_impact.trees_equivalent.toFixed(1);
            
            renderImpactChart();
        }

        function renderImpactChart() {
            const months = ['Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            const carbonData = months.map((m, i) => 50 + Math.sin(i) * 10 + Math.random() * 5);

            const trace = {
                x: months,
                y: carbonData,
                type: 'scatter',
                fill: 'tozeroy',
                mode: 'lines',
                line: { color: '#10b981', width: 3 },
                fillcolor: 'rgba(16, 185, 129, 0.2)'
            };

            const layout = {
                title: 'Carbon Footprint Reduction Over Time',
                xaxis: { title: 'Month' },
                yaxis: { title: 'CO‚ÇÇ Saved (kg)' }
            };

            Plotly.newPlot('impactChart', [trace], layout, {responsive: true});
        }

        function updateChallengesTab() {
            const activeChallenges = challenges.filter(c => c.status === 'active');
            const completedChallenges = challenges.filter(c => c.status === 'completed');

            renderChallenges('activeChallenges', activeChallenges);
            renderChallenges('completedChallenges', completedChallenges);
        }

        function renderChallenges(containerId, challengeList) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            if (challengeList.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No challenges here yet!</p>';
                return;
            }

            challengeList.forEach(challenge => {
                const item = document.createElement('div');
                item.className = `challenge-item ${challenge.status}`;
                
                const statusBadge = challenge.status === 'completed' 
                    ? '<span class="status-badge completed">‚úì Completed</span>'
                    : '<span class="status-badge active">‚óè Active</span>';

                item.innerHTML = `
                    <div class="challenge-header">
                        <div>
                            <div class="challenge-title">${challenge.name} ${statusBadge}</div>
                            <div class="challenge-desc">${challenge.description}</div>
                        </div>
                        <div class="challenge-reward">+${challenge.reward} pts</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${challenge.progress}%"></div>
                    </div>
                    <div class="progress-text">${challenge.progress}% complete</div>
                `;
                
                container.appendChild(item);
            });
        }

        // Initialize on load
        loadData();

        // Simulate real-time updates every 5 seconds
        setInterval(() => {
            const indicator = document.querySelector('.live-indicator');
            indicator.style.opacity = '0';
            setTimeout(() => indicator.style.opacity = '1', 200);
        }, 5000);
    </script>
</body>
</html>
