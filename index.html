<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duke Energy Challenge - Personal Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        /* ê¸°ì¡´ ë””ìì¸ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: white; border-radius: 15px; padding: 30px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; }
        .user-info { display: flex; align-items: center; gap: 20px; }
        .avatar { width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; font-size: 2em; color: white; font-weight: bold; }
        .user-details h1 { color: #333; font-size: 1.8em; margin-bottom: 5px; }
        .user-details p { color: #666; font-size: 1.1em; }
        .user-stats { display: flex; gap: 30px; }
        .stat-value { font-size: 2em; font-weight: bold; color: #667eea; }
        .stat-label { color: #666; font-size: 0.9em; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 15px; background: rgba(255,255,255,0.2); border: none; border-radius: 10px; color: white; font-size: 1.1em; font-weight: 600; cursor: pointer; transition: all 0.3s ease; backdrop-filter: blur(10px); }
        .tab.active { background: white; color: #667eea; }
        .tab-content { display: none; animation: fadeIn 0.5s ease; }
        .tab-content.active { display: block; }
        .card { background: white; border-radius: 15px; padding: 30px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .real-time-data { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .data-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px; position: relative; overflow: hidden; }
        .impact-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .impact-card { text-align: center; padding: 25px; background: #f5f7fa; border-radius: 12px; }
        .challenge-item { background: #f5f7fa; border-radius: 12px; padding: 20px; margin-bottom: 15px; border-left: 5px solid #667eea; }
        .progress-bar { background: rgba(0,0,0,0.1); height: 10px; border-radius: 5px; margin: 10px 0; }
        .progress-fill { height: 100%; background: #667eea; border-radius: 5px; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .live-indicator { display: inline-block; width: 8px; height: 8px; background: #4ade80; border-radius: 50%; margin-right: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="user-info">
                <div class="avatar">J</div>
                <div class="user-details">
                    <h1 id="userName">Jiyeong '27</h1>
                    <p id="userResidence">Trinity Residence Hall</p>
                </div>
            </div>
            <div class="user-stats">
                <div class="stat-item"><div class="stat-value" id="userRank">--</div><div class="stat-label">Building Rank</div></div>
                <div class="stat-item"><div class="stat-value" id="userPoints">850</div><div class="stat-label">Green Points</div></div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('profile')">ğŸ  Profile</button>
            <button class="tab" onclick="switchTab('impact')">ğŸŒ± Impact</button>
            <button class="tab" onclick="switchTab('challenges')">ğŸ† Challenges</button>
        </div>

        <div id="profile" class="tab-content active">
            <div class="card">
                <h2><span class="live-indicator"></span> Real-Time Energy Data</h2>
                <div class="real-time-data">
                    <div class="data-card"><h3>âš¡ Electricity</h3><div class="value" id="currentElectric">--</div><div class="unit">kWh this period</div></div>
                    <div class="data-card"><h3>ğŸ’§ Water</h3><div class="value" id="currentWater">--</div><div class="unit">gallons this period</div></div>
                    <div class="data-card"><h3>ğŸ“Š Efficiency</h3><div class="value" id="efficiencyRating">--</div><div class="unit">out of 100</div></div>
                </div>
            </div>
            <div class="card"><h2>ğŸ“ˆ Building Trends</h2><div id="monthlyChart"></div></div>
        </div>

        <div id="impact" class="tab-content">
            <div class="card">
                <h2>ğŸŒ Environmental Impact</h2>
                <div class="impact-grid">
                    <div class="impact-card"><h3>âš¡ Yearly</h3><div class="value" id="personalElectric">--</div><div class="unit">kWh</div></div>
                    <div class="impact-card"><h3>ğŸŒ«ï¸ COâ‚‚ Saved</h3><div class="value" id="carbonSaved">--</div><div class="unit">kg</div></div>
                    <div class="impact-card"><h3>ğŸŒ³ Trees</h3><div class="value" id="treesEquivalent">--</div><div class="unit">equivalent</div></div>
                </div>
            </div>
        </div>

        <div id="challenges" class="tab-content">
            <div class="card"><h2>ğŸ† Active Challenges</h2><div id="activeChallenges"></div></div>
        </div>
    </div>

    <script>
        // ìˆ˜ì • í¬ì¸íŠ¸: ë°ì´í„°ë¥¼ ì½”ë“œ ë‚´ë¶€ì— ì§ì ‘ ì •ì˜ (Self-contained)
        const dashboardData = {
            user: {
                name: "Jiyeong '27",
                residence: "Trinity Residence Hall",
                rank: 26,
                total_buildings: 32,
                current_consumption: { electric: 71502, water: 28325, last_updated: "2025-06-01" },
                personal_impact: { electric_yearly: 7775, water_yearly: 3108, carbon_saved: 5.4, trees_equivalent: 0.3 },
                monthly_history: [
                    { "End Date": "2024-12-01", "Commodity ": "Electric", "Common Use": 56794 },
                    { "End Date": "2025-01-01", "Commodity ": "Electric", "Common Use": 75455 },
                    { "End Date": "2025-02-01", "Commodity ": "Electric", "Common Use": 71905 },
                    { "End Date": "2025-03-01", "Commodity ": "Electric", "Common Use": 89337 },
                    { "End Date": "2025-04-01", "Commodity ": "Electric", "Common Use": 71374 },
                    { "End Date": "2025-05-01", "Commodity ": "Electric", "Common Use": 71502 }
                ]
            },
            challenges: [
                { name: "Energy Saver", description: "Reduce electricity by 10%", progress: 65, reward: 50, status: "active" },
                { name: "Green Leader", description: "Complete all eco-tips", progress: 100, reward: 25, status: "completed" }
            ]
        };

        function initializeDashboard() {
            const u = dashboardData.user;
            // UI ì—…ë°ì´íŠ¸
            document.getElementById('userRank').textContent = `${u.rank}/${u.total_buildings}`;
            document.getElementById('currentElectric').textContent = u.current_consumption.electric.toLocaleString();
            document.getElementById('currentWater').textContent = u.current_consumption.water.toLocaleString();
            document.getElementById('efficiencyRating').textContent = Math.round(100 - (u.rank/u.total_buildings*100));
            
            document.getElementById('personalElectric').textContent = u.personal_impact.electric_yearly.toLocaleString();
            document.getElementById('carbonSaved').textContent = u.personal_impact.carbon_saved;
            document.getElementById('treesEquivalent').textContent = u.personal_impact.trees_equivalent;

            renderCharts();
            renderChallenges();
        }

        function renderCharts() {
            const history = dashboardData.user.monthly_history;
            const trace = {
                x: history.map(d => d["End Date"]),
                y: history.map(d => d["Common Use"]),
                type: 'scatter', mode: 'lines+markers', line: {color: '#667eea'}
            };
            Plotly.newPlot('monthlyChart', [trace], { title: 'Electricity Usage Trend' });
        }

        function renderChallenges() {
            const container = document.getElementById('activeChallenges');
            dashboardData.challenges.forEach(c => {
                const div = document.createElement('div');
                div.className = 'challenge-item';
                div.innerHTML = `<strong>${c.name}</strong><p>${c.description}</p><div class="progress-bar"><div class="progress-fill" style="width:${c.progress}%"></div></div>`;
                container.appendChild(div);
            });
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            event.target.classList.add('active');
        }

        window.onload = initializeDashboard;
    </script>
</body>
</html>
